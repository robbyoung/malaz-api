include ./components/sceneText.pug

div#text-container(hx-swap-oob=oob)
    p(
        hx-get="/forms"
        hx-vars=`sceneId:"${sceneId}",range:(parseInt(window.getSelection().baseNode.parentElement.attributes["select-from"].value)+window.getSelection().baseOffset)+'-'+(parseInt(window.getSelection().extentNode.parentElement.attributes["select-from"].value)+window.getSelection().extentOffset)`
        hx-target="#selection"
        hx-swap="outerHTML"
        hx-trigger="mouseup"
        class="text-wrap padding-x padding-y"
    )
        each chunk in chunks
            if chunk.annotationId
                span(
                    hx-get=`/annotations/${chunk.annotationId}`
                    hx-target="#selection"
                    hx-swap="outerHTML"
                    hx-trigger="mouseup"
                    select-from=chunk.selectFrom
                    class=chunk.class
                ) #{chunk.text}
            else
                span(
                    select-from=chunk.selectFrom
                    class=chunk.class
                ) #{chunk.text}